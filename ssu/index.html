<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, maximum-scale=1.0, minimum-scale=1, user-scalable=yes,initial-scale=1.0">
  <title>Parallax</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="assets/scss/main.css">
</head>
<body>
  <div id="wrap">
    <header>
      <h1 class="left-logo">
        <a href="#">
          Sulwhasoo
        </a>
        <p>Rose Brand Site Contents</p>
      </h1>
      <div class="top-wrap">
        <div class="rang">
          <h2 class="hidden">언어선택</h2>
          <ul>
            <li><a href="#">한국/한국어</a></li>
            <li><a href="#">한국/한국어</a></li>
          </ul>
        </div>
        <a href="#" class="logo">Sulwhasoo</a>
        <div class="right">
          <a href="#">매장찾기</a>
          <a href="#">구매하기</a>
          <a href="#">검색히기</a>
        </div>
      </div>
      <nav>
        <h2 class="hidden">메뉴</h2>
        <ul class="menu-wrap">
          <li class="active">
            <a href="#">브랜드 빌리프</a>
            <ul class="sub-menu">
              <li><a href="#">설화수 포스트</a></li>
              <li><a href="#">설화수 포스트</a></li>
              <li><a href="#">설화수 포스트</a></li>
            </ul>
          </li>
          <li>
            <a href="#">베스트셀러</a>
            <ul class="sub-menu">
              <li><a href="#">설화수 포스트</a></li>
              <li><a href="#">설화수 포스트</a></li>
              <li><a href="#">설화수 포스트</a></li>
            </ul>
          </li>
          <li>
            <a href="#">제품</a>
            <ul class="sub-menu">
              <li><a href="#">설화수 포스트</a></li>
              <li><a href="#">설화수 포스트</a></li>
              <li><a href="#">설화수 포스트</a></li>
            </ul>
          </li>
          <li>
            <a href="#">스파</a>
            <ul class="sub-menu">
              <li><a href="#">설화수 포스트</a></li>
              <li><a href="#">설화수 포스트</a></li>
              <li><a href="#">설화수 포스트</a></li>
            </ul>
          </li>
          <li>
            <a href="#">플래그십 스토어</a>
            <ul class="sub-menu">
              <li><a href="#">설화수 포스트</a></li>
              <li><a href="#">설화수 포스트</a></li>
              <li><a href="#">설화수 포스트</a></li>
            </ul>
          </li>
        </ul>
      </nav>
    </header>
    <div class="container">
      <div class="intro">dd</div>
      <div class="cont1">
        <div class="cont1-top">
          <div class="cont1-film">
            <div class="film-box">
              <div class="film-txt">
                <h2 class="tit01">AMBASSADOR FILM</h2>
                <p class="film-txt-tit">PEOPLE BORN FROM MOTHER EARTH BECOME FLOWERS</p>
                <p class="film-txt-cont">
                  <span>"People Born from Mother Earth Become Flowers" depicts Sulwhasoo’s journey from past to present,</span>
                  <span>expressing Sulwhasoo’s spirit and image in cinematic fashion using earth, snow, and flowers as metaphorical symbols.</span>
                </p>
                <button type="button" class="film-next-btn">WATCH FILM</button>
              </div>
              <div class="back-img"></div>
            </div>
            <div class="film-box film-box-next">
              <div class="film-txt">
                <p class="tit01">AMBASSADOR FILM</p>
                <p class="film-txt-tit">PEOPLE BORN FROM MOTHER EARTH BECOME FLOWERS</p>
                <button type="button" class="film-prev-btn">BACK</button>
              </div>
            </div>
          </div>
        </div>
        <div class="cont1-full full-bg-box">
          <div class="full-bg-txt">
            <p class="full-bg-tit">
              <span>BORN FROM THE ENERGY</span>
              <span>OF MOTHER EARTH</span>
            </p>
            <p class="full-bg-sub">
              <span>Sulwhasoo’s shining journey toward beauty,</span>
              <span>which began in 1932 to help the beauty in every woman "blossom,"</span>
              <span>can be traced back directly to Mother Earth, the source of all things.</span>
            </p>
          </div>
          <div class="cont1-full-dim"></div>
        </div>
      </div>
      <div class="cont2">
        <div class="cont2-box">
          <div class="cont2-flow">
            <div class="flow-list flow1"><img src="assets/img/1.png" alt=""></div>
            <div class="flow-list flow2"><img src="assets/img/lazy2.jfif" alt=""></div>
            <div class="flow-list flow3"><img src="assets/img/3.png" alt=""></div>
          </div>
        </div>
      </div>
      <div class="cont3">
        <div class="cont3-box">
          <p><img src="assets/img/t2.jpg" alt=""></p>
        </div>
        <div class="cont3-back-img full-bg-img"></div>
      </div>
      <div class="cont4">
        <div class="cont4-back"></div>
        <div class="cont4-box">
          <div class="cont4-txt">
            ㅇㅇㅇ
          </div>
          <div class="cont4-story">
            12312128371283781273
          </div>
        </div>
      </div>
      <div class="cont5">
        <div class="cont5-back-img full-bg-img"></div>
        <div class="cont5-full full-bg-box">
          <div class="full-bg-txt">
            <p class="full-bg-tit">
              <span>마침내 찬란한</span>
              <span>꽃이 피어나다.</span>
            </p>
            <p class="full-bg-sub">
              <span>Sulwhasoo’s shining journey toward beauty,</span>
              <span>which began in 1932 to help the beauty in every woman "blossom,"</span>
              <span>can be traced back directly to Mother Earth, the source of all things.</span>
            </p>
          </div>
          <div class="cont1-full-dim"></div>
        </div>
      </div>
    </div>
  </div>
  <script>
    let flowBoxW = 0; // flowBox Width
    let flowLastW = 0; // flowList - last Width
    function init() {
      flowBoxWidth()
      fullSlide()
    }
    init()

    const cont1 = $('.cont1')
    const cont1offset = $('.cont1').offset().top
    const cont1TopH = $('.cont1-top').innerHeight()
    const cont1Bottom = $('.cont1-full').offset().top
    const cont1BotH = $('.cont1-top').innerHeight()

    const cont2 = $('.cont2')
    const cont2offset = $('.cont2').offset().top
    const cont2H = $('.cont2').innerHeight()
    const flowBoxoffset = $('.cont2-flow').offset().top

    const cont3 = $('.cont3')
    const cont3offset = $('.cont3').offset().top
    const cont3H = $('.cont3').innerHeight()

    const cont4 = $('.cont4')
    const cont4offset = $('.cont4').offset().top
    const cont4Boxoffset = $('.cont4-box').offset().top
    const cont4H = $('.cont4').innerHeight()

    const cont5 = $('.cont5')
    const cont5offset = $('.cont5').offset().top
    const cont5H = $('.cont5').innerHeight()

    /* cont1 - fullSlide */
    function fullSlide() {
      $('.film-next-btn').click(function() {
        $('.cont1-film').css({'left':'-' + 100 + '%'})
        $('html, body').animate({scrollTop:cont1offset}, 500)
        $('.cont1-film').on('scroll touchmove mousewheel', function(e){
            e.preventDefault();
            e.stopPropagation(); 
            return false;
          })
      })
      $('.film-prev-btn').click(function() {
        $('.cont1-film').css({'left':0});
        $('.cont1-film').off('scroll touchmove mousewheel'); 
      })
    }

    /* cont2 - flowBox width */
    function flowBoxWidth() {
      for (f = 0; f < $('.flow-list').length; f++) {
        let flowW = parseInt($('.flow'+(f + 1)).outerWidth(true))
        flowBoxW += flowW
        flowLastW = parseInt($('.flow'+($('.flow-list').length)).innerWidth())
      }
      $('.cont2').css({'height':flowBoxW})
      $('.cont2-flow').css({'width':flowBoxW})
    }

    $(document).scroll(function() {
  
      let winH = $(document).scrollTop()
      
      // scrollTop, scrollMin, scrollMax, content
      Motion(winH, cont1offset, cont1TopH, 'cont1Top')
      Motion(winH, cont1Bottom, cont1BotH, 'cont1Bottom')
      Motion(winH, cont2offset, flowBoxW, 'cont2')
      Motion(winH, cont3offset, cont3H, 'cont3')
      Motion(winH, cont4offset, cont4H, 'cont4')
      Motion(winH, cont4Boxoffset, cont4H, 'cont4Box')
    })

    function Motion(winH, contTop, contHeight, content) {
      let scrollMin = contTop
      let scrollMax = contTop + contHeight
  
      let min = 1 / (scrollMax - scrollMin)
      let max = -(min * scrollMin)
      let totalRange = (min * winH) + max

      if(content == 'cont1Top') {
        cont1Scale(totalRange, winH)
      } else if(content == 'cont1Bottom') {
        opacityScroll(totalRange, winH)
      } else if(content == 'cont2') {
        transScroll(totalRange, winH)
      } else if(content == 'cont3') {
        cont3Scale(totalRange, winH)
      } else if(content == 'cont4') {
        cont4Scroll(totalRange, winH)
      } else if(content == 'cont4Box') {
        cont4BoxLeft(totalRange, winH)
      } 
    }
  
    /* cont1 - scale */
    function cont1Scale(totalRange, winH) {
      if (winH >= cont1offset && winH <= cont1offset + cont1TopH) {
        if (totalRange <= 0.75) {
          $('.back-img').css({'transform':'scale('+ (0.25 + totalRange) +')'});
          $('.back-img').css({'bottom':170 - (totalRange * 170)});
        } else {
          return;
        } 
      } else if (winH <= cont1offset) {
        $('.back-img').prop('style').removeProperty('transform');
        $('.back-img').prop('style').removeProperty('bottom');
        return
      } else {
        $('.back-img').css({'transform':'scale(1)'});
        $('.back-img').css({"bottom":'0'});
        return
      }
    }
  
    /* cont1 - opacity */
    function opacityScroll(totalRange, winH) {

      if (winH >= cont1Bottom && winH <= cont1Bottom + cont1BotH) {
        $('.cont1-full-dim').css({'opacity':totalRange});
      } else {
        $('.cont1-full-dim').css({'opacity':0});
        return
      } 
    }

    /* cont2 - transform */
    function transScroll(totalRange, winH) {
      let transMin = cont2offset
      let transMax = cont2offset + flowBoxW
  
      let width1 = flowBoxW / (transMax - transMin)
      let width2 = -(width1 * transMin)
      let widthRange = (width1 * winH) + width2

      if (winH >= cont2offset && winH <= cont2offset + flowBoxW) {
          if(widthRange <= (flowBoxW / 2) - (flowLastW / 2)) {
            $('.cont2-box').css({'position':'fixed'})
            $('.cont2-box').prop('style').removeProperty('transform');
            $('.cont2-flow').css({'transform':'translate(-'+ widthRange  +'px, -'+ totalRange * 50 +'%)'});
          } else {
            $('.cont2-box').css({'position':'absolute', 'top':'auto', 'bottom':'0'})
            return
          }
      } else if (winH <= cont2offset){
        $('.cont2-box').removeAttr('style');
        $('.cont2-flow').prop('style').removeProperty('transform');
        return
      } else {
        $('.cont2-box').css({'position':'absolute', 'top':'0', 'bottom':'auto'}) 
        return
      }
    }

    /* cont3 - scale */
    function cont3Scale(totalRange, winH) {
      if (winH >= cont3offset && winH <= cont3offset + (cont3H / 2)) {
        if (totalRange <= 0.3) {
          $('.cont3-back-img').css({'top':'calc(100vh - '+ (100 - totalRange * 350) +'px)', 'transform':'scale('+ (0.7 + totalRange) +')'});
        } else {
          return;
        } 
      } else if (winH >= cont3offset + (cont3H / 2) && winH <= cont3offset + cont3H) {
        $('.cont3-back-img').css({'top':'0', 'transform':'scale('+ (0.7 + totalRange) +')'});
        $('.cont3-back-img').addClass('fix')
      } else if (winH <= cont3offset) {
        $('.cont3-back-img').removeAttr('style');
        $('.cont3-back-img').removeClass('fix')
        return
      }
    }

    /* cont4 - backImg */
    function cont4Scroll(totalRange, winH) {
      if (winH >= cont4offset && winH <= cont4offset + (cont4H / 3)) {
        $('.cont3-back-img').addClass('fix');
        $('.cont3-back-img').css({'top':'0','opacity':1 - (totalRange * 3)});
        cont4.removeClass('back-on');
        $('.cont4-txt').removeClass('back-on');
      } else if(winH >= cont4offset + (cont4H / 3)) {
        $('.cont3-back-img').removeClass('fix')
        cont4.addClass('back-on');
      } else {
        $('.cont3-back-img').css({'opacity':1});
        cont4.removeClass('back-on');
        return
      }
    }

    function cont4BoxLeft(totalRange, winH) {
      if (winH >= cont4Boxoffset && winH <= cont4offset + (cont4H / 3) * 2) {
        $('.cont4-box').css({'position':'fixed','top':'0','bottom':'auto','left':'-'+totalRange * 300+'%'})
      } else if (winH >= cont4offset + (cont4H / 3) * 2) {
        $('.cont4-box').css({'position':'absolute','top':'auto','bottom':'0','left':-100+'%'})
        if (((totalRange * 300) - 100) <= 100) {
          $('.cont5-back-img').css({'top':-(200 - (totalRange * 300)) +'px', 'transform':'scale('+ (0.7 + (totalRange / 2)) +')'});
        } else {
          return
        }
      } else {
        $('.cont4-box').prop('style').removeProperty('position');
        $('.cont4-box').css({'top':'0','bottom':'auto','left':0})
        return
      }
    }

    /* cont3 - scale */
  </script>
</body>
</html>